# AI 冒险引擎

---

> 一个由大型语言模型（LLM）驱动的动态文字冒险游戏引擎。本项目允许用户自定义独特的故事背景，并与 AI 游戏主持人（Game Master）互动，以体验一场由程序动态生成的、独一无二的叙事冒险。

本项目由 Vite 启动，使用 React、TypeScript 和 Ant Design 构建。其特色是采用流式传输的打字机风格界面，以提供沉浸式的用户体验。

## ✨ 主要特性

- **动态故事生成:** 游戏叙事由 LLM 根据玩家的选择实时生成。
- **可配置的故事背景:** 用户可以提供自己的故事背景、角色细节和开场设定，以创造一场独特的冒险。
- **流式打字机界面:** AI 游戏主持人的文本以打字机效果出现，增强沉浸感。
- **智能自动滚动:** 页面会自动滚动以显示最新内容，但如果用户手动向上滚动查阅历史，则自动滚动会暂停，避免冲突。
- **响应式设计:** 简洁、现代的UI，完美适配桌面和移动设备。
- **关注点分离架构:** 应用逻辑（前端）与AI提示词工程（Dify后端）解耦，实现了灵活且健壮的系统架构。

## 🛠️ 技术栈

- **前端框架:** React 19
- **构建工具:** Vite 6
- **编程语言:** TypeScript 5
- **UI 组件库:** Ant Design 5
- **样式方案:** Styled-components & Sass
- **状态管理:** Zustand
- **路由:** React Router 6
- **HTTP 请求:** Fetch API (用于流式传输)
- **后端服务:** [Dify](https://dify.ai/) 云服务或自托管的LLM平台。

## 🚀 快速上手

请遵循以下步骤在您的本地机器上设置并运行项目，以进行开发和测试。

### 环境要求

- Node.js (v18 或更高版本)
- pnpm (或您偏好的其他包管理工具，如 npm/yarn)

### 安装与设置

1.  **克隆仓库:**
    ```sh
    git clone https://github.com/your-username/ai-adventure-engine.git
    cd ai-adventure-engine
    ```

2.  **安装依赖:**
    ```sh
    pnpm install
    ```

3.  **设置环境变量:**
    在项目根目录下，通过复制示例文件来创建一个 `.env` 文件：
    ```sh
    cp .env.example .env
    ```
    然后，打开 `.env` 文件并填入您的 Dify API URL 和应用密钥：
    ```
    VITE_API_URL=https://your-dify-api-url/v1
    VITE_API_KEY=app-your-dify-app-key
    ```

4.  **配置 Dify 工作流:**
    本应用要求 Dify 后端有一个特定的提示词结构。
    - 前往您的 Dify 应用并创建一个 **Chatflow（工作流）**。
    - 在 **LLM（大语言模型）** 节点中，粘贴 `DIFY_PROMPT_TEMPLATE.md` 文件中提供的提示词模板。
    - 确保提示词中使用了类似 `{{#sys.creative_prompt#}}` 的变量，以接收前端传递的故事背景。

5.  **运行开发服务器:**
    ```sh
    pnpm run dev
    ```
    在浏览器中打开命令行提供的本地URL（通常是 `http://localhost:5173`）。

## 📖 工作原理

本应用采用一种混合式提示词模型：

-   **前端:** 管理UI、状态和用户定义的 **故事背景**（例如世界观、角色设定）。
-   **Dify 后端:** 包含一个固定的 **“引擎”提示词**，它定义了AI的核心行为、规则和输出格式（故事文本、一个分隔符，以及一个用于选项的JSON对象）。

在每一轮交互中，前端将玩家的动作和故事背景发送到 Dify API。Dify 将这些信息与其“引擎”提示词相结合，以一种可预测的、结构化的数据流生成下一段故事，前端随后解析并显示这些内容。

## 📄 开源协议

本项目采用 MIT 协议授权 - 详情请参阅 `LICENSE` 文件。
